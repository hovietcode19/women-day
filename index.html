<!DOCTYPE html>
<html lang="vi">
<head>
    <link rel="icon" href="assets\img\autumn.png" type="image/x-icon">
    <title>A4Luminous</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5d68f 0%, #e8a75d 50%, #d4915c 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Intro Screen */
        .intro-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #ff8c42 0%, #ffa45c 50%, #ffb876 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 40px;
            z-index: 10000;
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .intro-screen.fade-out {
            opacity: 0;
            transform: scale(1.1);
            pointer-events: none;
        }

        .intro-text-line {
            font-size: 3.5em;
            font-weight: bold;
            color: #fff;
            text-align: center;
            padding: 0 20px;
            letter-spacing: 0.1em;
        }

        .intro-text-line:nth-child(1) {
            font-size: 4em;
        }

        .intro-text-line:nth-child(3) {
            font-size: 2.2em;
            max-width: 800px;
        }

        .neon-char {
            display: inline-block;
            color: #fff;
            text-shadow: 
                0 0 10px #fff,
                0 0 20px #fff,
                0 0 30px #ffd700,
                0 0 40px #ffd700,
                0 0 50px #ffd700,
                0 0 60px #ffd700,
                0 0 70px #ffd700;
            animation: neonGlow 2s ease-in-out infinite;
            animation-delay: calc(var(--index) * 0.1s);
        }

        @keyframes neonGlow {
            0%, 100% {
                text-shadow: 
                    0 0 10px #fff,
                    0 0 20px #fff,
                    0 0 30px #ffd700,
                    0 0 40px #ffd700;
            }
            50% {
                text-shadow: 
                    0 0 20px #fff,
                    0 0 30px #fff,
                    0 0 40px #ffd700,
                    0 0 50px #ffd700,
                    0 0 60px #ffd700,
                    0 0 70px #ffd700,
                    0 0 80px #ffd700;
            }
        }

        .intro-button {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #ff8c42;
            border: none;
            padding: 20px 60px;
            font-size: 1.8em;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 40px rgba(255, 215, 0, 0.4);
            transition: all 0.3s ease;
            margin-top: 30px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .intro-button:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 50px rgba(255, 215, 0, 0.6);
            background: linear-gradient(135deg, #ffed4e, #ffd700);
        }

        .intro-heart-container {
            display: none;
        }

        /* Heart Burst Effect */
        .burst-particle {
            position: fixed;
            font-size: 40px;
            pointer-events: none;
            z-index: 10001;
            animation: burst 1.5s ease-out forwards;
        }

        @keyframes burst {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) scale(0.3) rotate(360deg);
            }
        }

        /* Sparkle Background */
        .sparkle {
            position: fixed;
            width: 3px;
            height: 3px;
            background: #ffd700;
            border-radius: 50%;
            animation: sparkleAnim 2s infinite;
            pointer-events: none;
        }

        @keyframes sparkleAnim {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }

        /* Falling Autumn Elements */
        .autumn-element {
            position: fixed;
            font-size: 25px;
            animation: fall linear infinite;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        /* Flying Elements */
        .flying-element {
            position: fixed;
            font-size: 20px;
            animation: flyUp 4s ease-in infinite;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes flyUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) scale(0.5);
                opacity: 0;
            }
        }

        /* Music Control */
        .music-control {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 248, 235, 0.95);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(139, 90, 43, 0.3);
            z-index: 1000;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(212, 145, 92, 0.4);
            max-width: 280px;
        }

        .music-btn {
            background: linear-gradient(135deg, #d4915c, #a0724e);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(139, 90, 43, 0.3);
            width: calc(100% - 10px);
        }

        .music-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 90, 43, 0.5);
        }

        .volume-control {
            width: 100%;
            margin: 10px 0;
        }

        .song-select {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid rgba(212, 145, 92, 0.5);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.9);
            color: #5d4037;
            font-size: 14px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .song-select:focus {
            outline: none;
            border-color: #d4915c;
            box-shadow: 0 0 10px rgba(212, 145, 92, 0.3);
        }

        .current-song {
            text-align: center;
            color: #8b5a2b;
            font-size: 0.85em;
            margin: 5px 0;
            font-weight: 600;
        }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 2;
            opacity: 0;
            transition: opacity 1s ease;
        }

        .container.show {
            opacity: 1;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 50px;
            animation: fadeInDown 1s;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header h1 {
            font-size: 3.5em;
            color: #8b5a2b;
            text-shadow: 3px 3px 6px rgba(139, 90, 43, 0.3);
            margin-bottom: 15px;
            font-weight: bold;
        }

        .header .date {
            font-size: 1.8em;
            color: #6b4423;
            text-shadow: 2px 2px 4px rgba(139, 90, 43, 0.2);
        }

        .header .class-name {
            font-size: 2.2em;
            color: #a0724e;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.3);
            margin-top: 10px;
            font-weight: bold;
        }

        .header-logo {
            max-width: 200px;
            margin: 20px auto;
            display: block;
        }

        /* Class Photo */
        .class-photo {
            text-align: center;
            margin: 40px 0;
            animation: zoomIn 1.2s;
        }

        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.5);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .photo-box {
            background: rgba(255, 248, 235, 0.95);
            padding: 40px;
            border-radius: 25px;
            box-shadow: 0 15px 50px rgba(139, 90, 43, 0.4);
            max-width: 90%;
            margin: 0 auto;
            border: 3px solid rgba(212, 145, 92, 0.5);
        }

        .photo-box h3 {
            color: #8b5a2b;
            font-size: 2em;
            margin-bottom: 20px;
            text-align: center;
        }

        .photo-decorations {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .class-photo img {
            max-width: 100%;
            width: 100%;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(139, 90, 43, 0.3);
            border: 4px solid rgba(212, 145, 92, 0.5);
            cursor: pointer;
            transition: all 0.3s;
        }

        .class-photo img:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 40px rgba(139, 90, 43, 0.5);
        }

        .photo-caption {
            margin-top: 20px;
            text-align: center;
            color: #a0724e;
            font-size: 1.2em;
            font-style: italic;
        }

        .view-btn {
            background: linear-gradient(135deg, #d4915c, #a0724e);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(139, 90, 43, 0.4);
        }

        .view-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 90, 43, 0.6);
        }

        /* Photo Modal */
        .photo-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s;
        }

        .photo-modal.active {
            display: flex;
        }

        .modal-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            animation: modalZoomIn 0.5s;
        }

        @keyframes modalZoomIn {
            from {
                transform: scale(0.3);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-content img {
            max-width: 100%;
            max-height: 90vh;
            border-radius: 15px;
            box-shadow: 0 0 50px rgba(212, 145, 92, 0.5);
        }

        .close-btn {
            position: absolute;
            top: -15px;
            right: -15px;
            background: white;
            color: #8b5a2b;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .close-btn:hover {
            transform: rotate(90deg);
            background: #8b5a2b;
            color: white;
        }

        .love-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4em;
            color: white;
            text-shadow: 3px 3px 10px rgba(139, 90, 43, 0.8);
            font-weight: bold;
            opacity: 0;
            animation: loveTextAnim 2s forwards;
            animation-delay: 0.5s;
            pointer-events: none;
        }

        @keyframes loveTextAnim {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0);
            }
            50% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .burst-element {
            position: absolute;
            font-size: 30px;
            animation: burstAnim 1s forwards;
            pointer-events: none;
        }

        @keyframes burstAnim {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(0);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(2) translate(var(--tx), var(--ty));
            }
        }

        /* Message Section */
        .message-section {
            background: rgba(255, 248, 235, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(139, 90, 43, 0.3);
            margin: 40px 0;
            animation: fadeInUp 1.5s;
            border: 2px solid rgba(212, 145, 92, 0.4);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-section h2 {
            color: #8b5a2b;
            font-size: 2em;
            margin-bottom: 20px;
            text-align: center;
        }

        .message-section p {
            font-size: 1.2em;
            line-height: 1.8;
            color: #5d4037;
            text-align: center;
        }

        /* Wishes Form */
        .wishes-form {
            background: rgba(255, 248, 235, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(139, 90, 43, 0.3);
            margin: 40px 0;
            border: 2px solid rgba(212, 145, 92, 0.4);
        }

        .wishes-form h2 {
            color: #8b5a2b;
            font-size: 2em;
            margin-bottom: 25px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #a0724e;
            font-size: 1.1em;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(212, 145, 92, 0.5);
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.9);
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #d4915c;
            box-shadow: 0 0 15px rgba(212, 145, 92, 0.3);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .submit-btn {
            background: linear-gradient(135deg, #d4915c, #a0724e);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.2em;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            box-shadow: 0 8px 25px rgba(139, 90, 43, 0.4);
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(139, 90, 43, 0.6);
        }

        /* Wishes Display */
        .wishes-display {
            margin-top: 40px;
        }

        .wishes-display h3 {
            color: #8b5a2b;
            font-size: 1.8em;
            margin-bottom: 25px;
            text-align: center;
        }

        .wish-item {
            background: linear-gradient(135deg, #fff8e7, #ffefd5);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(139, 90, 43, 0.2);
            border-left: 4px solid #d4915c;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .wish-item .name {
            color: #8b5a2b;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .wish-item .message {
            color: #5d4037;
            font-size: 1em;
            line-height: 1.6;
        }

        .wish-item .time {
            color: #999;
            font-size: 0.9em;
            margin-top: 8px;
            font-style: italic;
        }

        .no-wishes {
            text-align: center;
            color: #a0724e;
            font-size: 1.1em;
            padding: 30px;
        }

        @media (max-width: 768px) {
            .intro-text-line {
                font-size: 2em;
            }
            .intro-text-line:nth-child(1) {
                font-size: 2.5em;
            }
            .intro-text-line:nth-child(3) {
                font-size: 1.3em;
            }
            .intro-button {
                font-size: 1.3em;
                padding: 15px 40px;
            }
            .music-control {
                max-width: 250px;
            }
        }
    </style>
</head>
<body>
    <!-- Intro Screen -->
    <div class="intro-screen" id="introScreen">
        <div class="intro-text-line" id="line1"></div>
        <div class="intro-text-line" id="line2"></div>
        <div class="intro-text-line" id="line3"></div>
        <button class="intro-button" onclick="startExperience()">Tiếp Tục →</button>
    </div>

    <!-- Music Control -->
    <div class="music-control">
        <div class="current-song" id="currentSong">🎵 Đang chọn bài...</div>
        <select class="song-select" id="songSelect">
            <option value="assets/sound/Bình Yên - Vũ.mp3">🍂 Bình Yên - Vũ</option>
            <option value="assets/sound/Cứ Chill Thôi - Chillies.mp3">🍁 Cứ Chill Thôi - Chillies</option>
            <option value="assets/sound/Lối Nhỏ - Đen Vâu.mp3">🍎 Lối Nhỏ - Đen Vâu</option>
            <option value="assets/sound/Quá Lâu - Vinh Khuất.mp3">🌸 Quá Lâu - Vinh Khuất</option>
        </select>
        <button class="music-btn" id="toggleMusic">⏸️ Tạm dừng</button>
        <input type="range" class="volume-control" id="volumeControl" min="0" max="100" value="70">
        <div style="text-align: center; color: #a0724e; font-size: 0.9em; margin-top: 5px;">
            <span id="volumeText">70%</span>
        </div>
    </div>

    <audio id="bgMusic" loop>
        <source src="assets/sound/Bình Yên - Vũ.mp3" type="audio/mpeg">
    </audio>

    <div class="container" id="mainContainer">
        <!-- Header -->
        <div class="header">
            <h1>🍂 Chúc Mừng 20/10 🍂</h1>
            <p class="date">Ngày Phụ Nữ Việt Nam</p>
            <p class="class-name">Lớp A4Luminous</p>
            <img src="logo.png" alt="A4Luminous Logo" class="header-logo" onerror="this.style.display='none'">
        </div>

        <!-- Class Photo -->
        <div class="class-photo">
            <div class="photo-box">
                <div class="photo-decorations">
                    <span>🍂</span>
                    <span>🍎</span>
                    <span>🍁</span>
                    <span>🍎</span>
                    <span>🍂</span>
                </div>
                <h3>🍂 Ảnh Lớp A4Luminous 🍂</h3>
                <img src="assets/img/BÌA.jpg" alt="Lớp A4Luminous" onclick="openPhotoModal()">
                <p class="photo-caption">✨ Những bông hoa xinh đẹp của A4Luminous trong sắc thu ✨</p>
                <button class="view-btn" onclick="openPhotoModal()">🔍 Xem ảnh phóng to</button>
            </div>
        </div>

        <!-- Photo Modal -->
        <div class="photo-modal" id="photoModal" onclick="closePhotoModal(event)">
            <div class="modal-content" onclick="event.stopPropagation()">
                <button class="close-btn" onclick="closePhotoModal(event)">✕</button>
                <img src="assets/img/BÌA.jpg" alt="Lớp A4Luminous">
                <div class="love-text" id="loveText">💕 YÊU LỚP NHIỀU 💕</div>
            </div>
        </div>

        <!-- Message Section -->
        <div class="message-section">
            <h2>🍎 Lời Chúc Đặc Biệt 🍎</h2>
            <p>
                Gửi đến tất cả các bạn nữ xinh đẹp, tài năng của lớp A4Luminous! 🍂
            </p>
            <p style="margin-top: 20px;">
                Chúc các bạn luôn rạng rỡ như ánh nắng mùa thu, ấm áp và tỏa sáng như những trái táo chín đỏ. 
                Mong rằng các bạn sẽ luôn có những ngày tháng thật vui vẻ, hạnh phúc và thành công trên con đường phía trước!
            </p>
            <p style="margin-top: 20px; font-size: 1.4em; color: #8b5a2b; font-weight: bold;">
                20/10 - Yêu các bạn nhiều lắm! 🍎
            </p>
        </div>

        <!-- Wishes Form -->
        <div class="wishes-form">
            <h2>✍️ Gửi Lời Chúc</h2>
            <form id="wishForm">
                <div class="form-group">
                    <label for="senderName">Tên của bạn:</label>
                    <input type="text" id="senderName" placeholder="Nhập tên của bạn..." required>
                </div>
                
                <div class="form-group">
                    <label>Loại lời chúc:</label>
                    <div style="display: flex; gap: 20px; margin-top: 10px;">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="radio" name="wishType" value="public" checked style="margin-right: 8px; width: 18px; height: 18px;">
                            <span style="color: #5d4037;">🍂 Gửi cho cả lớp</span>
                        </label>
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="radio" name="wishType" value="private" style="margin-right: 8px; width: 18px; height: 18px;">
                            <span style="color: #5d4037;">🍎 Gửi riêng cho một người</span>
                        </label>
                    </div>
                </div>

                <div class="form-group" id="recipientGroup" style="display: none;">
                    <label for="recipientName">Tên người nhận:</label>
                    <input type="text" id="recipientName" placeholder="Nhập tên người bạn muốn gửi...">
                </div>
                
                <div class="form-group">
                    <label for="wishMessage">Lời chúc của bạn:</label>
                    <textarea id="wishMessage" placeholder="Viết lời chúc của bạn tại đây..." required></textarea>
                </div>
                <button type="submit" class="submit-btn">🍂 Gửi Lời Chúc</button>
            </form>

            <!-- Check Private Wishes -->
            <div style="margin-top: 40px; padding-top: 40px; border-top: 2px solid rgba(212, 145, 92, 0.3);">
                <h3 style="color: #8b5a2b; font-size: 1.8em; margin-bottom: 25px; text-align: center;">🍎 Xem Lời Chúc Riêng Của Bạn</h3>
                <div class="form-group">
                    <label for="checkName">Nhập tên của bạn để xem lời chúc:</label>
                    <input type="text" id="checkName" placeholder="Nhập tên của bạn...">
                </div>
                <button type="button" class="view-btn" onclick="checkPrivateWishes()" style="width: 100%; margin-top: 10px;">🔍 Xem Lời Chúc Dành Cho Tôi</button>
            </div>

            <!-- Wishes Display -->
            <div class="wishes-display">
                <h3>💬 Lời Chúc Công Khai</h3>
                <div id="wishesContainer">
                    <p class="no-wishes">Chưa có lời chúc công khai nào. Hãy là người đầu tiên gửi lời chúc! 🍂</p>
                </div>
            </div>
        </div>

        <!-- Private Wishes Modal -->
        <div class="photo-modal" id="privateWishesModal" onclick="closePrivateWishesModal(event)">
            <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 800px; width: 90%; background: rgba(255, 248, 235, 0.98); padding: 40px; border-radius: 25px; max-height: 80vh; overflow-y: auto;">
                <button class="close-btn" onclick="closePrivateWishesModal(event)">✕</button>
                <h2 style="color: #8b5a2b; text-align: center; margin-bottom: 30px; font-size: 2em;">🍎 Lời Chúc Dành Cho <span id="recipientNameDisplay"></span></h2>
                <div id="privateWishesContainer"></div>
            </div>
        </div>
    </div>

    <script>
        // Create neon text effect
        function createNeonText(text, container) {
            container.innerHTML = '';
            const chars = text.split('');
            chars.forEach((char, index) => {
                const span = document.createElement('span');
                span.className = 'neon-char';
                span.textContent = char === ' ' ? '\u00A0' : char;
                span.style.setProperty('--index', index);
                container.appendChild(span);
            });
        }

        // Initialize intro text
        createNeonText('Hola', document.getElementById('line1'));
        createNeonText('Chúc mừng 20/10', document.getElementById('line2'));
        createNeonText('Các bông hoa đã sẵn sàng chưa, click tiếp tục nhé', document.getElementById('line3'));

        function startExperience() {
            document.getElementById('introScreen').classList.add('fade-out');
            document.getElementById('mainContainer').classList.add('show');
            
            const audio = document.getElementById('bgMusic');
            audio.volume = 0.7;
            
            audio.play().catch(() => {
                document.getElementById('toggleMusic').textContent = '▶️ Phát nhạc';
                isPlaying = false;
            });
            
            setTimeout(() => {
                document.getElementById('introScreen').style.display = 'none';
            }, 800);
        }

        const toggleBtn = document.getElementById('toggleMusic');
        const volumeControl = document.getElementById('volumeControl');
        const volumeText = document.getElementById('volumeText');
        const songSelect = document.getElementById('songSelect');
        const currentSongDisplay = document.getElementById('currentSong');
        let isPlaying = true;

        function updateCurrentSong() {
            const selectedOption = songSelect.options[songSelect.selectedIndex];
            currentSongDisplay.textContent = selectedOption.text;
        }

        songSelect.addEventListener('change', () => {
            const audio = document.getElementById('bgMusic');
            if (!audio) return;
            
            const wasPlaying = !audio.paused;
            
            audio.src = songSelect.value;
            audio.load();
            
            if (wasPlaying) {
                audio.play().catch(() => {
                    toggleBtn.textContent = '▶️ Phát nhạc';
                    isPlaying = false;
                });
            }
            
            updateCurrentSong();
        });

        toggleBtn.addEventListener('click', () => {
            const audio = document.getElementById('bgMusic');
            if (!audio) return;
            
            if (isPlaying) {
                audio.pause();
                toggleBtn.textContent = '▶️ Phát nhạc';
            } else {
                audio.play().catch(() => {
                    alert('Vui lòng tương tác với trang để phát nhạc');
                });
                toggleBtn.textContent = '⏸️ Tạm dừng';
            }
            isPlaying = !isPlaying;
        });

        volumeControl.addEventListener('input', (e) => {
            const audio = document.getElementById('bgMusic');
            if (audio) {
                audio.volume = e.target.value / 100;
            }
            volumeText.textContent = e.target.value + '%';
        });

        updateCurrentSong();

        function createSparkles() {
            for (let i = 0; i < 50; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = Math.random() * 100 + '%';
                sparkle.style.top = Math.random() * 100 + '%';
                sparkle.style.animationDelay = Math.random() * 2 + 's';
                document.body.appendChild(sparkle);
            }
        }

        function createAutumnElements() {
            const elements = ['🍂', '🍁', '🍎'];
            setInterval(() => {
                const element = document.createElement('div');
                element.className = 'autumn-element';
                element.textContent = elements[Math.floor(Math.random() * elements.length)];
                element.style.left = Math.random() * 100 + '%';
                element.style.animationDuration = (Math.random() * 3 + 5) + 's';
                element.style.opacity = Math.random() * 0.5 + 0.5;
                document.body.appendChild(element);

                setTimeout(() => element.remove(), 8000);
            }, 500);
        }

        function createFlyingElements() {
            const elements = ['🍂', '🍎'];
            setInterval(() => {
                const element = document.createElement('div');
                element.className = 'flying-element';
                element.textContent = elements[Math.floor(Math.random() * elements.length)];
                element.style.left = Math.random() * 100 + '%';
                element.style.bottom = '0';
                element.style.animationDelay = Math.random() + 's';
                document.body.appendChild(element);

                setTimeout(() => element.remove(), 4000);
            }, 800);
        }

        const publicWishes = [];
        const privateWishes = [];
        
        document.querySelectorAll('input[name="wishType"]').forEach(radio => {
            radio.addEventListener('change', (e) => {
                const recipientGroup = document.getElementById('recipientGroup');
                const recipientName = document.getElementById('recipientName');
                if (e.target.value === 'private') {
                    recipientGroup.style.display = 'block';
                    recipientName.required = true;
                } else {
                    recipientGroup.style.display = 'none';
                    recipientName.required = false;
                    recipientName.value = '';
                }
            });
        });
        
        function displayWishes() {
            const container = document.getElementById('wishesContainer');
            
            if (publicWishes.length === 0) {
                container.innerHTML = '<p class="no-wishes">Chưa có lời chúc công khai nào. Hãy là người đầu tiên gửi lời chúc! 🍂</p>';
                return;
            }

            container.innerHTML = publicWishes.map(wish => `
                <div class="wish-item">
                    <div class="name">🍂 ${wish.name}</div>
                    <div class="message">${wish.message}</div>
                    <div class="time">${wish.time}</div>
                </div>
            `).join('');
        }

        function checkPrivateWishes() {
            const checkName = document.getElementById('checkName').value.trim();
            
            if (!checkName) {
                alert('🍂 Vui lòng nhập tên của bạn!');
                return;
            }
            
            const myWishes = privateWishes.filter(wish => 
                wish.recipient.toLowerCase() === checkName.toLowerCase()
            );
            
            if (myWishes.length === 0) {
                alert('🍎 Chưa có lời chúc nào dành cho bạn!');
                return;
            }
            
            const modal = document.getElementById('privateWishesModal');
            const container = document.getElementById('privateWishesContainer');
            const nameDisplay = document.getElementById('recipientNameDisplay');
            
            nameDisplay.textContent = checkName;
            
            container.innerHTML = myWishes.map(wish => `
                <div class="wish-item">
                    <div class="name">🍎 Từ: ${wish.sender}</div>
                    <div class="message">${wish.message}</div>
                    <div class="time">${wish.time}</div>
                </div>
            `).join('');
            
            modal.classList.add('active');
        }

        function closePrivateWishesModal(event) {
            const modal = document.getElementById('privateWishesModal');
            modal.classList.remove('active');
        }

        function openPhotoModal() {
            const modal = document.getElementById('photoModal');
            modal.classList.add('active');
            
            setTimeout(() => {
                createElementBurst();
            }, 300);
        }

        function closePhotoModal(event) {
            const modal = document.getElementById('photoModal');
            modal.classList.remove('active');
            
            document.querySelectorAll('.burst-element').forEach(e => e.remove());
        }

        function createElementBurst() {
            const modal = document.getElementById('photoModal');
            const elements = ['🍂', '🍁', '🍎'];
            
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const element = document.createElement('div');
                    element.className = 'burst-element';
                    element.textContent = elements[Math.floor(Math.random() * elements.length)];
                    element.style.left = '50%';
                    element.style.top = '50%';
                    
                    const angle = (Math.PI * 2 * i) / 20;
                    const distance = 200;
                    element.style.setProperty('--tx', Math.cos(angle) * distance + 'px');
                    element.style.setProperty('--ty', Math.sin(angle) * distance + 'px');
                    
                    modal.appendChild(element);
                    
                    setTimeout(() => element.remove(), 1000);
                }, i * 30);
            }
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closePhotoModal(e);
                closePrivateWishesModal(e);
            }
        });

        document.getElementById('wishForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const SHEET_URL = 'https://script.google.com/macros/s/AKfycbyzvVzGBeCmJEetRm9a3FnuYONSEijbM_GhszJYTfmQ0Euuu_AaTAuhCCsq1MpGnfZLag/exec'; // <--- THAY URL CỦA BẠN VÀO ĐÂY

            const senderName = document.getElementById('senderName').value.trim();
            const message = document.getElementById('wishMessage').value.trim();
            const wishType = document.querySelector('input[name="wishType"]:checked').value;
            const recipientName = document.getElementById('recipientName').value.trim();

            if (!senderName || !message) {
                alert('🍂 Vui lòng điền đầy đủ thông tin!');
                return;
            }

            if (wishType === 'private' && !recipientName) {
                alert('🍎 Vui lòng nhập tên người nhận!');
                return;
            }

            const now = new Date();
            const timeStr = now.toLocaleString('vi-VN');

            // Gửi dữ liệu lên Google Sheet
            const payload = wishType === 'public'
            ? { type: 'public', sender: senderName, message }
            : { type: 'private', sender: senderName, recipient: recipientName, message };

            await fetch(SHEET_URL, {
                method: 'POST',
                body: JSON.stringify(payload),
            });

            alert(wishType === 'public' 
                ? '✨ Lời chúc công khai của bạn đã được gửi thành công! 🍂'
                : `✨ Lời chúc riêng của bạn đã được gửi đến ${recipientName}! 🍎`
            );

            // Làm mới form
            document.getElementById('senderName').value = '';
            document.getElementById('wishMessage').value = '';
            document.getElementById('recipientName').value = '';
            document.querySelector('input[name="wishType"][value="public"]').checked = true;
            document.getElementById('recipientGroup').style.display = 'none';

            // Tải lại danh sách lời chúc công khai
            if (wishType === 'public') loadPublicWishes();
        });

        async function loadPublicWishes() {
            const SHEET_URL = 'https://script.google.com/macros/s/AKfycbyzvVzGBeCmJEetRm9a3FnuYONSEijbM_GhszJYTfmQ0Euuu_AaTAuhCCsq1MpGnfZLag/exec'; // <--- Thay URL của bạn
            const res = await fetch(`${SHEET_URL}?action=public`);
            const json = await res.json();

            const container = document.getElementById('wishesContainer');
            if (!json.ok || !json.data || json.data.length === 0) {
                container.innerHTML = '<p class="no-wishes">Chưa có lời chúc công khai nào. 🍂</p>';
                return;
            }

            container.innerHTML = json.data.map(wish => `
                <div class="wish-item">
                    <div class="name">🍂 ${wish.sender}</div>
                    <div class="message">${wish.message}</div>
                    <div class="time">${new Date(wish.time).toLocaleString('vi-VN')}</div>
                </div>
            `).join('');
        }

        async function checkPrivateWishes() {
            const checkName = document.getElementById('checkName').value.trim();
            if (!checkName) return alert('🍂 Vui lòng nhập tên của bạn!');
            
            const SHEET_URL = 'https://script.google.com/macros/s/AKfycbyzvVzGBeCmJEetRm9a3FnuYONSEijbM_GhszJYTfmQ0Euuu_AaTAuhCCsq1MpGnfZLag/exec'; // <--- Thay URL của bạn
            const res = await fetch(`${SHEET_URL}?action=private&recipient=${encodeURIComponent(checkName)}`);
            const json = await res.json();
            
            const modal = document.getElementById('privateWishesModal');
            const container = document.getElementById('privateWishesContainer');
            const nameDisplay = document.getElementById('recipientNameDisplay');
            nameDisplay.textContent = checkName;

            if (!json.ok || !json.data || json.data.length === 0) {
                container.innerHTML = '<p class="no-wishes">🍎 Không có lời chúc nào dành cho bạn!</p>';
            } else {
                container.innerHTML = json.data.map(wish => `
                    <div class="wish-item">
                        <div class="name">🍎 Từ: ${wish.sender}</div>
                        <div class="message">${wish.message}</div>
                        <div class="time">${new Date(wish.time).toLocaleString('vi-VN')}</div>
                    </div>
                `).join('');
            }

            modal.classList.add('active');
        }

        createSparkles();
        createAutumnElements();
        createFlyingElements();
        displayWishes();
    </script>
</body>
</html>